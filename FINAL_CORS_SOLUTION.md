# –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ CORS –ø—Ä–æ–±–ª–µ–º—ã

## üîç –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞:

CORS middleware –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏! –í –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
```
üåê –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π origin: https://swiezdo.github.io/tsushimaru_app/
```

–ù–æ –≤ –∫–æ–¥–µ –º—ã –∏–∑–º–µ–Ω–∏–ª–∏ –Ω–∞ `allow_origins=["*"]`.

## üîß –†–µ—à–µ–Ω–∏–µ:

### 1. –û–±–Ω–æ–≤–∏—Ç–µ app.py –Ω–∞ Raspberry Pi

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `app.py` —Å:
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º CORS –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `allow_origins=["*"]`
- `allow_credentials=False`

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–∏—Å

```bash
# –ù–∞ Raspberry Pi
sudo systemctl restart miniapp_api
sudo systemctl status miniapp_api
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞

```bash
# –ù–∞ Raspberry Pi
sudo journalctl -u miniapp_api -f
```

**–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:**
```
üîß CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: allow_origins=['*']
üöÄ –ó–∞–ø—É—Å–∫ Tsushima Mini App API...
```

### 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ OPTIONS –∑–∞–ø—Ä–æ—Å

```bash
# –ù–∞ Raspberry Pi
python3 test_api_direct.py
```

**–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
3. –¢–µ—Å—Ç–∏—Ä—É–µ–º OPTIONS —Å CORS –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏...
   Status: 200  ‚Üê –í–º–µ—Å—Ç–æ 400!
   Response: 
```

### 5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ Mini App –≤ Telegram
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ü—Ä–æ—Ñ–∏–ª—å"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É
4. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

–í –ª–æ–≥–∞—Ö API –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üîß CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: allow_origins=['*']
üöÄ –ó–∞–ø—É—Å–∫ Tsushima Mini App API...
üìÅ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: /home/ubuntu/miniapp_api/app.db
üåê –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π origin: https://swiezdo.github.io/tsushimaru_app/
ü§ñ Bot token: 8310172124...
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

–ò –±–æ–ª—å—à–µ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
INFO: "OPTIONS /api/profile.save HTTP/1.1" 400 Bad Request
```

## ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

–ö–æ–≥–¥–∞ CORS –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –≤–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```python
# –í app.py –≤–µ—Ä–Ω–∏—Ç–µ:
allow_origins=[ALLOWED_ORIGIN],
allow_credentials=True,
```

–ù–æ —Å–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞! üöÄ
